[![zread](https://img.shields.io/badge/Ask_Zread-_.svg?style=flat&color=00b0aa&labelColor=000000&logo=data%3Aimage%2Fsvg%2Bxml%3Bbase64%2CPHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTQuOTYxNTYgMS42MDAxSDIuMjQxNTZDMS44ODgxIDEuNjAwMSAxLjYwMTU2IDEuODg2NjQgMS42MDE1NiAyLjI0MDFWNC45NjAxQzEuNjAxNTYgNS4zMTM1NiAxLjg4ODEgNS42MDAxIDIuMjQxNTYgNS42MDAxSDQuOTYxNTZDNS4zMTUwMiA1LjYwMDEgNS42MDE1NiA1LjMxMzU2IDUuNjAxNTYgNC45NjAxVjIuMjQwMUM1LjYwMTU2IDEuODg2NjQgNS4zMTUwMiAxLjYwMDEgNC45NjE1NiAxLjYwMDFaIiBmaWxsPSIjZmZmIi8%2BCjxwYXRoIGQ9Ik00Ljk2MTU2IDEwLjM5OTlIMi4yNDE1NkMxLjg4ODEgMTAuMzk5OSAxLjYwMTU2IDEwLjY4NjQgMS42MDE1NiAxMS4wMzk5VjEzLjc1OTlDMS42MDE1NiAxNC4xMTM0IDEuODg4MSAxNC4zOTk5IDIuMjQxNTYgMTQuMzk5OUg0Ljk2MTU2QzUuMzE1MDIgMTQuMzk5OSA1LjYwMTU2IDE0LjExMzQgNS42MDE1NiAxMy43NTk5VjExLjAzOTlDNS42MDE1NiAxMC42ODY0IDUuMzE1MDIgMTAuMzk5OSA0Ljk2MTU2IDEwLjM5OTlaIiBmaWxsPSIjZmZmIi8%2BCjxwYXRoIGQ9Ik0xMy43NTg0IDEuNjAwMUgxMS4wMzg0QzEwLjY4NSAxLjYwMDEgMTAuMzk4NCAxLjg4NjY0IDEwLjM5ODQgMi4yNDAxVjQuOTYwMUMxMC4zOTg0IDUuMzEzNTYgMTAuNjg1IDUuNjAwMSAxMS4wMzg0IDUuNjAwMUgxMy43NTg0QzE0LjExMTkgNS42MDAxIDE0LjM5ODQgNS4zMTM1NiAxNC4zOTg0IDQuOTYwMVYyLjI0MDFDMTQuMzk4NCAxLjg4NjY0IDE0LjExMTkgMS42MDAxIDEzLjc1ODQgMS42MDAxWiIgZmlsbD0iI2ZmZiIvPgo8cGF0aCBkPSJNNCAxMkwxMiA0TDQgMTJaIiBmaWxsPSIjZmZmIi8%2BCjxwYXRoIGQ9Ik00IDEyTDEyIDQiIHN0cm9rZT0iI2ZmZiIgc3Ryb2tlLXdpZHRoPSIxLjUiIHN0cm9rZS1saW5lY2FwPSJyb3VuZCIvPgo8L3N2Zz4K&logoColor=ffffff)](https://zread.ai/Zxy876/DriftSystem)
# DriftSystem Â· å¿ƒæ‚¦å®‡å®™
> Fully natural-language-driven AI adventure system for Minecraft

## Overview
DriftSystem (å¿ƒæ‚¦å®‡å®™) å°† Minecraft æœåŠ¡å™¨ä¸ AI æ•…äº‹å¼•æ“èåˆï¼Œç©å®¶åªéœ€è‡ªç„¶è¯­è¨€å³å¯é©±åŠ¨å‰§æƒ…ã€æ”¹é€ ä¸–ç•Œã€åˆ›å»ºå…³å¡å¹¶æ¨è¿›å¤šäººååŒå†’é™©ã€‚Java æ’ä»¶è´Ÿè´£å³æ—¶åé¦ˆä¸ä¸–ç•Œæ¸²æŸ“ï¼ŒPython FastAPI åç«¯æä¾›æ„å›¾è¯†åˆ«ã€å‰§æƒ…ç¼–æ’ã€DSL æ³¨å…¥å’Œæ•™ç¨‹/ä»»åŠ¡é€»è¾‘ã€‚

## Core Highlights
- å¤šæ„å›¾è‡ªç„¶è¯­è¨€ç®¡çº¿ï¼š`IntentRouter2` + `IntentDispatcher2` å®ç°èŠå¤©é©±åŠ¨çš„ä¸€å‘å¤šå‘½ä»¤è§£æã€‚
- Heart Levels å‰§æƒ…å¼•æ“ï¼šå†…ç½® 30+ ç« èŠ‚ï¼Œæ”¯æŒå‰§æƒ…åˆ†æ”¯ã€æ¨èã€æ•…äº‹åˆ›ä½œä¸å°åœ°å›¾å¯¼èˆªã€‚
- ä¸–ç•Œ/é•œå¤´ç³»ç»Ÿï¼š`SceneAwareWorldPatchExecutor`ã€HUDã€CinematicController ä¸ NPC ç®¡ç†å™¨è”åŠ¨å®ŒæˆåŠ¨æ€æ¸²æŸ“ã€‚
- æ•™å­¦ä¸åˆ›ä½œä½“éªŒï¼šTutorialManager ä¿æŠ¤æ–°æ‰‹æµç¨‹ï¼ŒStoryCreativeManager æ”¯æŒç©å®¶å³å…´ DSL æ³¨å…¥ã€‚
- FastAPI åç«¯ï¼šç»“æ„åŒ– API è¦†ç›–æ„å›¾ã€ä¸–ç•Œã€å‰§æƒ…ã€NPCã€æ•™ç¨‹ã€æç¤ºã€æ ‘å½¢ DSLã€MiniMap PNGã€‚

## Architecture
```
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚ Minecraft    â”‚
              â”‚ Paper 1.20.x â”‚
              â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ Bukkit API
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ DriftSystem Plugin      â”‚
        â”‚ Java 17 + Maven         â”‚
        â”‚ - èŠå¤©ç›‘å¬ + æ„å›¾è·¯ç”±   â”‚
        â”‚ - ä¸–ç•Œ/å‰§æƒ…/æ•™ç¨‹å¼•æ“    â”‚
        â”‚ - HUD + Cinematic + NPC â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ HTTP/JSON
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚ FastAPI Backend         â”‚
        â”‚ Python 3.10+            â”‚
        â”‚ - AI Intent / Story DSL â”‚
        â”‚ - Heart Levels æ•°æ®      â”‚
        â”‚ - ä¸–ç•Œ/åœ°å›¾ REST æ¥å£    â”‚
        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Repository Layout
```
backend/               FastAPI æœåŠ¡ã€æ ¸å¿ƒå‰§æƒ…/ä¸–ç•Œå¼•æ“ä¸æ•°æ®é›†
system/mc_plugin/      Minecraft æ’ä»¶æºç ã€æ„å»ºè„šæœ¬ã€æ’ä»¶å…ƒæ•°æ®
docs/                  ç³»ç»Ÿè®¾è®¡ã€å‰§æƒ…ã€å…³å¡ DSL è¯´æ˜
phases/                Heart Universe é¡¹ç›®é˜¶æ®µè§„åˆ’
tools/, scripts        æ„å»ºã€ä¿®å¤ã€éƒ¨ç½²è‡ªåŠ¨åŒ–è„šæœ¬
server/, backend/server å†…ç½® Paper æœåŠ¡å™¨ä¸å ä½èµ„æºï¼ˆå¿½ç•¥äº§ç‰©ï¼‰
```

## Quick Start
1. å®‰è£… Python 3.10+, Java 17+, Maven 3.6+, Paper 1.20.xã€‚
2. åœ¨é¡¹ç›®æ ¹æ‰§è¡Œï¼š
   ```bash
   ./start_all.sh
   ```
   è„šæœ¬ä¼šåˆ›å»º venvã€å®‰è£…åç«¯ä¾èµ–ã€å¯åŠ¨ FastAPIã€ç¼–è¯‘æ’ä»¶å¹¶å¤åˆ¶åˆ°åµŒå…¥å¼æœåŠ¡å™¨ã€‚
3. è¿›å…¥ `backend/server` å¯åŠ¨ Paperï¼š
   ```bash
   java -Xmx4G -Xms2G -jar paper-*.jar
   ```
4. æ¸¸æˆå†…æ‰§è¡Œ `/drift status` æ£€æŸ¥è”é€šï¼Œç„¶åç›´æ¥ç”¨è‡ªç„¶è¯­è¨€å¯¹è¯ã€‚

## Manual Workflow
**åç«¯**
```bash
cd backend
python3 -m venv venv
source venv/bin/activate
pip install -r requirements.txt
uvicorn app.main:app --host 0.0.0.0 --port 8000 --reload
```

**æ’ä»¶**
```bash
cd system/mc_plugin
mvn clean package
```
ç”Ÿæˆçš„ `target/DriftSystem-*.jar` å¤åˆ¶åˆ°æœåŠ¡å™¨ `plugins/` ç›®å½•ã€‚

**æœåŠ¡å™¨é…ç½®**
ç¼–è¾‘ `backend/server/plugins/DriftSystem/config.yml`ï¼š
```yaml
backend_url: "http://127.0.0.1:8000"
system:
  debug: false
story:
  start_level: "level_01"
world:
  allow_world_modification: true
```

## Configuration & Secrets
- `backend/.env` (ä¸éšä»“åº“æäº¤)ï¼š`DEEPSEEK_API_KEY`ã€`OPENAI_BASE_URL`ã€`OPENAI_MODEL`ã€‚
- Paper æœåŠ¡å™¨å±æ€§ï¼š`backend/server/server.properties`ã€`eula.txt` ç­‰æŒ‰éœ€è‡ªå®šã€‚
- æ’ä»¶è°ƒè¯•ï¼š`debug.task_token` å…è®¸ `/taskdebug` å‘½ä»¤è®¿é—®å—é™æ¥å£ã€‚

## Development & Testing
- è¿è¡Œåç«¯æµ‹è¯•ï¼š`cd backend && pytest` æˆ– `./test_all.sh`ã€‚
- æ„å»ºæ’ä»¶ï¼š`cd system/mc_plugin && mvn package`ï¼Œå¯é…åˆ `./build.sh` å¿«æ·è„šæœ¬ã€‚
- é›†æˆè„šæœ¬ï¼š`test_all.sh`, `test_integration.sh`, `test_story.sh`, `test_tutorial.sh` ç­‰è¦†ç›–å‰§æƒ…ã€ä»»åŠ¡ã€è‡ªæ„ˆæµç¨‹ã€‚
- è‡ªæ£€ï¼š`drift_backend_selftest.py` / `backend/drift_backend_selftest.py` æä¾›å¿«é€Ÿå›å½’ã€‚

## Content & Docs
- Heart Levels å†…å®¹ä½äº `backend/data/heart_levels/` ä¸ `backend/data/flagship_levels/`ã€‚
- DSLã€å‰§æƒ…ã€æƒ…ç»ªç³»ç»Ÿç­‰è¯¦è§ `docs/*.md`ã€`NPC_BEHAVIORS_TESTING.md`ã€`TUTORIAL_SYSTEM.md`ã€‚
- `phases/` ä¿å­˜é¡¹ç›®è·¯çº¿å›¾ä¸é˜¶æ®µæ€§å™äº‹è®¾è®¡ã€‚

## Minecraft Commands
- `/drift status|sync|debug`ï¼šæ ¸å¿ƒçŠ¶æ€ä¸åŒæ­¥ã€‚
- `/storycreative`, `/recommend`, `/questlog`ï¼šHUDã€æ¨èä¸åˆ›ä½œå…¥å£ã€‚
- `/taskdebug <token>`ï¼šæ„å›¾ä»»åŠ¡è°ƒè¯•å‘½ä»¤ï¼ˆéœ€è¦é…ç½®ä»¤ç‰Œï¼‰ã€‚
- è‡ªå®šä¹‰å‘½ä»¤ `tp2`, `time2`, `sayc`, `npc`, `cinematic` ç­‰å¯¹åº”ä¸–ç•Œè°ƒåº¦ä¸ NPC ç®¡ç†ã€‚

## Tooling & Automation
- `start_all.sh`ï¼šä¸€é”®æ„å»ºå¯åŠ¨ã€‚
- `build_plugin.sh`, `build_and_deploy_plugin.sh`, `make_plugin.sh`ï¼šéƒ¨ç½²æµæ°´çº¿ã€‚
- `fix_*.sh` ä¸ `tools/`ï¼šè‡ªåŠ¨ä¿®å¤/ç»“æ„åŒ–è„šæœ¬ï¼Œè¾…åŠ©è°ƒè¯•æˆ–è¿ç§»ã€‚

## Troubleshooting
- åç«¯è¿é€šï¼š`curl http://127.0.0.1:8000/`ï¼Œæ—¥å¿—ä½äº `backend/backend.log`ã€‚
- æ’ä»¶é…ç½®ï¼šç¡®ä¿ `config.yml` backend_url ä¸å®é™…ç«¯å£ä¸€è‡´ã€‚
- ä¸–ç•Œæ— å“åº”ï¼šå¯ç”¨ `system.debug: true`ï¼Œå…³æ³¨æœåŠ¡å™¨æ§åˆ¶å°ä¸ `/taskdebug` è¾“å‡ºã€‚
- æ¸…ç†æ•™ç¨‹çŠ¶æ€ï¼š`/reload` å‰æ‰§è¡Œ `TutorialManager.cleanupPlayer`ï¼Œæˆ–é‡å¯æœåŠ¡å™¨é‡ç½®ã€‚

## Contributing
æ¬¢è¿é€šè¿‡ Issueã€Pull Requestã€å‰§æƒ…å†…å®¹æˆ– DSL æ ·ä¾‹å‚ä¸ã€‚æäº¤å‰è¯·è·‘é€šåç«¯æµ‹è¯•å¹¶ç¡®è®¤ `system/mc_plugin/target/`ã€`backend/venv/` ç­‰äº§ç‰©æœªçº³å…¥ç‰ˆæœ¬æ§åˆ¶ã€‚

## License
æœ¬é¡¹ç›®ä»¥ [MIT License](./LICENSE) æˆæƒå‘å¸ƒï¼Œå¯è‡ªç”±ä½¿ç”¨ã€ä¿®æ”¹ä¸åˆ†å‘ã€‚è¯¦è§ä»“åº“ä¸­çš„ `LICENSE` æ–‡ä»¶ã€‚

**è®©å‰§æƒ…åœ¨Minecraftä¸­è‡ªç„¶ç”Ÿé•¿** ğŸŒ±

**ä½“éªŒå®Œå…¨ç”±å¯¹è¯é©±åŠ¨çš„å†’é™©ä¹‹æ—…** ğŸš€
